<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<link rel="icon" type="image/svg+xml" href="favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<title>ThreeJS Planet System</title>
	</head>
	<body class="loading">
		<noscript>
			Sorry, but <em>The Orrery</em> will not work without JavaScript enabled. Please enable it to continue.
		</noscript>
		<canvas id="bg"></canvas>
		<main id="app-orrery">
			<div class="loading-spinner-container">
				<div class="loading-spinner">
					<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg">
						<path
							d="M15.542 1.487A21.507 21.507 0 00.5 22c0 11.874 9.626 21.5 21.5 21.5 9.847 0 18.364-6.675 20.809-16.072a1.5 1.5 0 00-2.904-.756C37.803 34.755 30.473 40.5 22 40.5 11.783 40.5 3.5 32.217 3.5 22c0-8.137 5.3-15.247 12.942-17.65a1.5 1.5 0 10-.9-2.863z"
						></path>
					</svg>
				</div>
				<figure class="progress-bar">
					<div id="bar"></div>
				</figure>
			</div>

			<div class="container-fluid ui">
				<div class="ui-top">
					<div class="row">
						<div class="col-2 col-lg-3">
							<div class="time-container">
								<button type="button" class="btn btn-rounded">
									<i class="fas fa-clock"></i>
								</button>
								<button type="button" class="btn btn-rounded d-none d-lg-inline-block">
									<i class="fas fa-backward"></i>
								</button>
								<button type="button" class="btn btn-rounded d-none d-lg-inline-block">
									<i class="fas fa-pause"></i>
								</button>
								<button type="button" class="btn btn-rounded d-none d-lg-inline-block">
									<i class="fas fa-forward"></i>
								</button>
							</div>
						</div>
						<div class="col">
							<div class="system-container">
								<button type="button" class="btn btn-rounded" @click="goToPreviousSystem()">
									<i class="fas fa-angle-left"></i>
								</button>
								<h2 class="h2" v-html="currentSystem"></h2>
								<button type="button" class="btn btn-rounded" @click="goToNextSystem()">
									<i class="fas fa-angle-right"></i>
								</button>
							</div>
						</div>
						<div class="col-2 col-lg-3">
							<div class="search-container" :class="{'active': searchQuery && searchLoaded}">
								<button type="button" class="btn btn-rounded d-lg-none">
									<i class="fas fa-search"></i>
								</button>
								<div id="search" class="search d-none d-lg-block">
									<i class="fas fa-search"></i>
									<input
										class="form-control"
										type="seach"
										placeholder="Search"
										v-model="searchQuery"
										@keyup="updateSearch"
										@keyup.enter="updateZoomTarget(searchResults[0].index)"
									/>
									<div class="search-dropdown" v-if="searchLoaded">
										<ul>
											<li v-for="(result, i) in searchResults">
												<a :href="'/#/' + result.id" @click="updateZoomTarget(result.index)">
													<span v-html="result.displayName"></span> <span class="text-type">{{ result.type }}</span>
												</a>
											</li>
											<li v-if="!searchResults.length">
												<span class="no-results">No results found.</span>
											</li>
										</ul>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="ui-bottom" :class="{'hide-moons': !showMoons}" v-if="clickedClassData">
					<div class="row">
						<div class="col-12 col-md-6 offset-md-3">
							<div class="title-container">
								<button type="button" class="btn btn-rounded" @click="goToPreviousEntity()">
									<i class="fas fa-angle-left"></i>
								</button>
								<div class="title-wrapper">
									<h3 class="h3 text-entity-color">{{ clickedClassData.displayName }}</h3>
									<span class="text-type">{{ clickedClassData.type }}</span>
								</div>
								<button type="button" class="btn btn-rounded" @click="goToNextEntity()">
									<i class="fas fa-angle-right"></i>
								</button>
							</div>
							<div class="key-data-container">
								<ul>
									<li v-if="clickedClassData.type !== 'Star'">
										<span class="heading">Distance</span>
										<span v-html="distanceFromParentEntity"></span>
									</li>
									<li>
										<span class="heading">Mean Radius</span>
										<span class="label-color"
											>{{ new Intl.NumberFormat('en-US').format(clickedClassData.meanRadius) }}</span
										>
										km
									</li>
									<li v-if="sideralOrbit">
										<span class="heading">Orbit Time</span>
										<span class="label-color">{{ sideralOrbit }}</span> Earth {{ clickedClassData.sideralOrbit < 366 ?
										'Days' : 'Years' }}
									</li>
									<li>
										<span class="heading">Surface Temp</span>
										<span class="label-color">{{ clickedClassData.avgTemp }}</span> Â°C
									</li>
									<li v-if="clickedClassData.mass && clickedClassData.massValue">
										<span class="heading">Mass</span>
										<span class="label-color">
											{{ clickedClassData.mass.massValue.toFixed(2) }}
											<span style="text-transform: none">x</span> 10<sup>{{ clickedClassData.mass.massExponent }}</sup>
										</span>
										kg
									</li>
								</ul>
								<div class="row">
									<div class="col-4">
										<button
											type="button"
											class="btn btn-show-moons"
											@click="showMoons = !showMoons"
											v-show="moons.length"
										>
											<img src="img/moon.svg" width="16" />
											<span v-if="showMoons">
												Hide Moons
												<i class="fas fa-angle-down"></i>
											</span>
											<span v-else>
												Show Moons
												<i class="fas fa-angle-up"></i>
											</span>
										</button>
									</div>
									<div class="col-4 text-center">
										<button type="button" class="btn btn-readmore">
											Read More
											<img src="img/arrow-right.svg" width="16" />
										</button>
									</div>
								</div>
							</div>

							<div class="moons-container" v-show="moons.length">
								<hr />

								<div class="label-moons animate-in">
									<span>Moon<span v-if="moons.length > 1">s</span></span>
									&nbsp;<span v-if="moons.length > 1">({{ moons.length }})</span>
								</div>

								<div id="moon-groups-wrapper" class="btn-group-wrapper" v-show="Object.keys(moonGroups).length > 1">
									<div class="btn-group animate-in" role="group">
										<template v-for="moonGroup in Object.values(moonGroups)">
											<input
												type="radio"
												class="btn-check"
												name="moon-group"
												:id="moonGroup.id"
												autocomplete="off"
												@change="updateMoonGroup(moonGroup.id)"
											/>
											<label class="btn btn-outline-primary btn-moon-group" :for="moonGroup.id">
												{{ moonGroup.name }} <span class="badge">{{ moonGroup.count }}</span>
											</label>
										</template>
									</div>
								</div>

								<div class="btn-group-wrapper" :key="moonGroupRefresh">
									<div class="btn-group-custom animate-in" role="group">
										<span
											v-for="moon in moons"
											v-show="modelMoonGroupSelection[clickedClassData.systemId] === moon.moonGroupId"
										>
											<input
												type="radio"
												class="btn-check"
												name="moon"
												:id="moon.id"
												autocomplete="off"
												:checked="modelSystemSelection[clickedClassData.systemId] === moon.id"
											/>
											<label class="btn btn-underline" :for="moon.id" @click="updateClickTarget(moon.index)">
												{{ moon.displayName }}
											</label>
										</span>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Modal -->
			<div class="modal fade" id="modal-info" tabindex="-1" aria-labelledby="modal-info-label" aria-hidden="true">
				<div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title" id="modal-info-label">Info</h5>
							<button type="button" class="btn-close btn-rounded" data-bs-dismiss="modal" aria-label="Close"></button>
						</div>
						<div class="modal-body"></div>
						<div class="modal-footer">
							<a id="modal-info-read-more" target="_blank" nofollow>Read More</a>
						</div>
					</div>
				</div>
			</div>
		</main>

		<script
			src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
			integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB"
			crossorigin="anonymous"
		></script>
		<script
			src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
			integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
			crossorigin="anonymous"
		></script>
		<script type="module" src="./main.js"></script>
	</body>
</html>
